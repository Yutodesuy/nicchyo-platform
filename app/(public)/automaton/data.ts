export interface Problem {
  id: string;
  question: string;
  answer: string;
  explanation: string;
}

export const problems: Problem[] = [
  {
    id: "4.3",
    question: "Turing機械 M について、以下のふたつの主張が同値であることを示せ：(i) 非負整数を係数とするある多項式 p: Z≥0 → Z≥0 が存在し、M は p(n) 時間である。(ii) ある k ∈ Z≥0 が存在して、M は O(n^k) 時間である。",
    answer: "定義より直接導かれる。",
    explanation: "O(n^k) の定義は、ある定数 c, n0 が存在して、すべての n > n0 に対して実行時間が c*n^k 以下になることである。多項式 p(n) = a_m n^m + ... + a_0 が存在して実行時間が p(n) 以下であるとする。n^m の係数が正であれば、十分に大きな n に対して p(n) ≤ (a_m + 1)n^m となり、これは O(n^m) である。逆に O(n^k) ならば、実行時間は c*n^k 以下であり、単項式 c*n^k は多項式の特別な場合である。"
  },
  {
    id: "4.4",
    question: "t(n) ≥ n となるような函数とする。このとき、すべての t(n) 時間複数テープ Turing 機械に対して、それと等価な O(t^2(n)) 時間単一テープ Turing 機械が存在することを示せ。",
    answer: "テープの内容を区切り文字で連結してシミュレートする。",
    explanation: "k本のテープを持つTMを1本のテープでシミュレートする場合、1本のテープ上に # T1 # T2 # ... # Tk # のように内容を並べる。各ステップで、シミュレータは全テープのヘッド位置を確認し、書き込み・移動を行う必要がある。最悪の場合、データ全体をシフトする必要があり、テープ上のデータ量は O(t(n)) であるため、1ステップのシミュレーションに O(t(n)) かかる。よって全体で O(t(n)^2) となる。"
  },
  {
    id: "4.5",
    question: "すべての文脈自由言語が計算量クラス P に属することを示せ。",
    answer: "CYK法などを用いる。",
    explanation: "文脈自由文法 (CFG) はChomsky標準形に変換可能である。Chomsky標準形の文法に対して、長さ n の入力文字列が生成可能かどうかは、CYKアルゴリズムを用いることで O(n^3) 時間で判定できる。O(n^3) は多項式時間であるため、CFL ⊆ P である。"
  },
  {
    id: "4.6",
    question: "f: Σ* → Σ* を多項式時間計算可能函数とする。Iter_f(0^n, x) := f(f(...f(x)...)) (n回適用) は多項式時間計算可能か？",
    answer: "一般には多項式時間計算可能ではない。",
    explanation: "反例：f(x) = xx とする。fは入力の長さを2倍にするため、O(|x|) 時間で計算可能である。しかし、n回適用すると出力の長さは |x| * 2^n となる。これは n に対して指数関数的な長さであり、書き出すだけで指数時間かかるため、多項式時間では計算できない。"
  },
  {
    id: "4.7",
    question: "次の論理式は充足可能であるか？ (x ∨ y) ∧ (x ∨ ¬y) ∧ (¬x ∨ y) ∧ (¬x ∧ ¬y)",
    answer: "充足不可能である。",
    explanation: "最後の節 (¬x ∧ ¬y) が真となるには、x = False かつ y = False でなければならない。しかし、このとき第1節 (x ∨ y) は (False ∨ False) = False となる。すべての節を同時に満たす割り当てが存在しないため、充足不可能である。"
  },
  {
    id: "4.8",
    question: "SAT が NP 完全であることを NP 完全性の定義に基づいて証明せよ（Cook-Levinの定理）。",
    answer: "任意の NP 問題の検証機（Verifier）の計算過程を論理式で表現する。",
    explanation: "任意の NP 言語 L に対して、多項式時間検証機 V(w, c) が存在する。入力 w に対し、ある証拠 c が存在して V が受理するかどうかは、V の計算ステップ（Turing機械の構成遷移）を論理変数で表現し、それらの整合性をとる巨大な論理式 φ_w を構成することで判定できる。φ_w が充足可能であることと、V が w を受理するような c が存在することは同値である。この変換は多項式時間で行えるため、SAT は NP 完全である。"
  },
  {
    id: "4.9",
    question: "3SAT が NP 完全であることを示せ。",
    answer: "SAT ≤p 3SAT を示す。",
    explanation: "任意の CNF 論理式の各節を 3リテラル以下の節に変換する。k > 3 のリテラルを持つ節 (l1 ∨ l2 ∨ ... ∨ lk) は、新しい変数を導入して (l1 ∨ l2 ∨ z1) ∧ (¬z1 ∨ l3 ∨ z2) ... のように分割することで、充足可能性を保ったまま 3CNF に変換できる。これは多項式時間で可能である。"
  },
  {
    id: "4.10",
    question: "2SAT が多項式時間で判定可能であることを示せ。",
    answer: "含意グラフの強連結成分分解を用いる。",
    explanation: "2CNF の各節 (A ∨ B) は (¬A → B) かつ (¬B → A) という含意関係と等価である。これを有向グラフ（含意グラフ）として表現する。論理式が充足不可能である必要十分条件は、ある変数 x に対して x から ¬x へのパスと、¬x から x へのパスが共に存在すること（つまり x と ¬x が同じ強連結成分にあること）である。強連結成分分解は線形時間で行えるため、2SAT は P に属する。"
  },
  {
    id: "4.11",
    question: "VertexCover が NP 完全であることを示せ。",
    answer: "3SAT ≤p VertexCover を示す。",
    explanation: "3SAT の論理式からグラフを構成する。各変数 x について (x, ¬x) のペアノードを作り、各節 (l1 ∨ l2 ∨ l3) について三角形のガジェットを作る。これらを適切に辺で結ぶことで、論理式が充足可能であるときかつそのときに限り、特定のサイズ k の頂点被覆が存在するように構成できる。"
  },
  {
    id: "4.12",
    question: "HamPath が NP 完全であることを示せ。",
    answer: "3SAT または VertexCover からの帰着を用いる（通常は 3SAT ≤p HamCycle ≤p HamPath）。",
    explanation: "3SAT の各変数と節をグラフ上の特定のコンポーネント（ダイヤモンド構造など）に変換し、それらを直列に繋ぐ。変数の真偽値に応じてパスの進む方向を選べるようにし、すべての節コンポーネントを通過できるようなパスが存在するかどうかを、論理式の充足可能性と対応させる。"
  },
  {
    id: "4.13",
    question: "GraphIso が NP に属することを示せ。",
    answer: "同型写像（置換）を証拠（Certificate）とする。",
    explanation: "グラフ G と H が同型であるための証拠は、頂点集合の間の全単射 φ である。与えられた φ が実際に同型写像になっているか（すなわち (u, v) ∈ E(G) ⇔ (φ(u), φ(v)) ∈ E(H)）は多項式時間で検証可能である。よって NP に属する。"
  },
  {
    id: "4.14",
    question: "Connected が多項式時間で判定可能であることを示せ。",
    answer: "BFS または DFS を用いる。",
    explanation: "グラフ G が連結であるかは、任意の頂点 s から探索（BFS/DFS）を開始し、すべての頂点が訪問済みになるかを確認すればよい。これは O(V+E) であり多項式時間である。"
  },
  {
    id: "4.15",
    question: "Partition が NP 完全であることを示せ。",
    answer: "SubsetSum ≤p Partition を示す。",
    explanation: "Partition は集合 S を和が等しい2つの部分集合に分割できるかという問題。SubsetSum（集合 S とターゲット t があり、和が t になる部分集合があるか）から帰着できる。S の総和を Σ とするとき、Partition はターゲットが Σ/2 の SubsetSum の特殊ケースに見えるが、証明には SubsetSum からの変換が必要である。"
  },
  {
    id: "4.16",
    question: "3Color が NP 完全であることを示せ。",
    answer: "3SAT ≤p 3Color を示す。",
    explanation: "3SAT の論理式からグラフを構成する。True, False, Base の3色を用意し、各変数が True か False の色しか取れないようなパレットガジェットを作る。各節に対しては、リテラルのどれかが True 色であることを強制する OR ガジェットを接続する。これにより 3彩色可能性と充足可能性が同値になる。"
  },
  {
    id: "4.17",
    question: "TQBF が PSPACE 困難であることを示せ。",
    answer: "多項式空間 Turing 機械の動作を論理式でシミュレートする。",
    explanation: "Savitchの定理の証明と同様に、ある構成 C1 から C2 へ 2^k ステップで到達可能かという述語 Reach(C1, C2, k) を再帰的に定義する。「中間点 Cm が存在して、前半と後半で到達可能である」という形にし、量化子 ∃Cm ∀(side ∈ {L, R}) を用いることで論理式のサイズを多項式に抑えることができる。"
  },
  {
    id: "4.18",
    question: "限定子に続く部分が論理積標準形 (CNF) であるような TQBF が依然として PSPACE 完全であることを示せ。",
    answer: "新たな変数を導入して CNF 化する。",
    explanation: "任意の TQBF の論理式部分は、Tseitin変換と同様の手法で、新しい存在量化変数を導入することで、充足可能性を保ったまま多項式時間で CNF に変換できる。量化子の順序構造は PSPACE 困難性に本質的であり、最内層が CNF であっても計算量は変わらない。"
  },
  {
    id: "4.19",
    question: "任意の PSPACE 困難な言語は、NP 困難でもあることを示せ。",
    answer: "NP ⊆ PSPACE であることを利用する。",
    explanation: "言語 A が PSPACE 困難であるとは、任意の L ∈ PSPACE に対して L ≤p A であることである。ここで NP ⊆ PSPACE であるため、任意の L' ∈ NP に対して L' ∈ PSPACE でもあり、したがって L' ≤p A が成り立つ。これは A が NP 困難であることの定義そのものである。"
  },
  {
    id: "4.20",
    question: "NL 完全性を定義する際、多項式時間計算可能函数（Poly-time reduction）を用いるとどのような不都合が生じるか？",
    answer: "NL ⊆ P であるため、NL 内の構造を区別できなくなる。",
    explanation: "もし多項式時間帰着を用いると、任意の P の問題（NLを含む）が帰着を行う関数そのもので解けてしまう可能性がある。特に、もし NL ≠ P であっても、任意の非自明な P の問題が NL 完全になってしまう（Cook-Levinのような意味で）。NL のような小さなクラスの完全性を議論するには、そのクラスよりも計算能力の低い帰着（対数領域帰着）を用いる必要がある。"
  },
  {
    id: "4.21",
    question: "f(n) ≥ n のとき、単一テープTMと(入力+作業)2テープTMでの空間計算量 SPACE(f(n)) の定義は同値であることを示せ。",
    answer: "単一テープで入力を保存しながら計算できるため。",
    explanation: "f(n) ≥ n ならば、単一テープTMでも入力データを消さずに保持するためのスペース（nセル）が f(n) の範囲内に収まる。したがって、入力テープが別にあるか、同じテープにあるかは定数倍の違いにしかならず、O(f(n)) 空間のクラスとしては変わらない。違いが出るのは f(n) < n (sub-linear space) の場合のみである。"
  },
  {
    id: "4.22",
    question: "NL ⊆ P が成り立つことを示せ。",
    answer: "NL 完全問題（Reachability）が P に属することから示せる。",
    explanation: "NL は、有向グラフ上の到達可能性問題 (Reachability) に対数領域帰着可能である。Reachability は BFS や DFS を用いることで O(V+E) の多項式時間で解ける。よって、任意の NL 問題は多項式時間で解ける。"
  },
  {
    id: "4.23",
    question: "Add (二進整数の加算) が L に属することを示せ。",
    answer: "桁ごとの加算と繰り上がり計算を行うだけなので、対数領域で可能。",
    explanation: "2つの n ビット整数の加算を行う際、i ビット目の計算に必要なのは i ビット目の入力値と、i-1 ビット目からの繰り上がり (carry) だけである。carry の計算はその桁までの情報だけで決定でき、インデックス i を保持するのに O(log n) の空間があれば十分である。"
  },
  {
    id: "4.24",
    question: "Mult (二進整数の乗算) が L に属することを示せ。",
    answer: "乗算は TC0 に属し、TC0 ⊆ L であるため（あるいは筆算のシミュレーション）。",
    explanation: "基本的な筆算アルゴリズムは O(log n) 空間で管理できる。各ビットの計算において、部分積の和を計算すればよい。多数の数の足し算になるが、これも対数領域で実行可能である。"
  },
  {
    id: "4.25",
    question: "A_DFA が L に属することを示せ。",
    answer: "DFA のシミュレーションは現在の状態を記憶するだけでよい。",
    explanation: "DFA M と入力 w が与えられたとき、シミュレーションに必要なのは「現在 M がどの状態にいるか」と「入力 w のどこを読んでいるか」という情報だけである。状態数は定数（入力サイズの一部だが、Mの記述サイズに対して対数）であり、入力ヘッドの位置は O(log |w|) で表現できる。よって対数領域で判定可能。"
  },
  {
    id: "4.26",
    question: "A_NFA が NL 完全であることを示せ。",
    answer: "Reachability と同値であるため。",
    explanation: "NFA が w を受理するかどうかは、NFA の状態遷移図（および w の遷移）を展開したグラフ上で、開始状態から受理状態へのパスが存在するかどうかという到達可能性問題に帰着される。これは NL で可能。逆に Reachability は A_NFA の特殊ケース（アルファベットサイズ1のNFAなど）とみなせるため、NL 完全である。"
  },
  {
    id: "4.27",
    question: "E_DFA (DFAの言語が空) が NL 完全であることを示せ。",
    answer: "グラフの到達可能性問題（補問題）に帰着される。",
    explanation: "DFA の言語が空であるとは、開始状態から受理状態へのパスが存在しないことである。これは Reachability の補問題（Non-Reachability）である。NL = coNL (Immerman–Szelepcsényi theorem) より、これも NL 完全である（あるいは単純に、パス探索はNLで、その否定もNL）。"
  },
  {
    id: "4.28",
    question: "Cycle (有向巡回を含む) が NL 完全であることを示せ。",
    answer: "Reachability からの帰着。",
    explanation: "有向グラフにサイクルがあるかは、ある頂点 v から v 自身への非自明なパスがあるかを確認すればよい。これは NL で判定可能である。完全性は、Reachability(s, t) を Cycle に帰着させることで示せる（t から s への辺を追加し、サイクルができるかを判定する）。"
  }
];
