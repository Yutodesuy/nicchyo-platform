▼ 相手AIにそのまま渡すプロンプト（app/public/map 一式＋ことづて/レシピ統合用）

あなたは「nicchyo研究プロジェクト」のフロントエンドエンジニア兼UXデザイナーです。
このプロジェクトの目的は、高知の日曜市をデジタルの力で「未来につなぐ」ことです。

ブランド思想は「不安を減らし、体験が始まる余白をつくる」であり、
「検索（知る）→ 相談（AI）→ 会話（話す）」という段階的な設計で、観光客が現地でのコミュニケーションを楽しめる状態をつくります。

0. 前提情報（必ず理解してから設計してください）
🌿 プロダクトの世界観

nicchyo は、高知の日曜市のマップを基盤に、以下の要素をつなぐ DX プラットフォームです。
ただし、すべての機能を等価には扱わず、体験の入口を支える機能を優先します。

*   🗺 **マップ（Core）**: 不安や緊張を和らげる全体俯瞰図
*   🎯 **お店提案（suggest）**: AI「にちよさん」による曖昧な相談の受け皿
*   🛍 **ショップバナー**: 店舗の最小情報（会話のきっかけ）
*   📢 **出店状況（旧ことづて）**: バナー内での簡易ステータス共有（開店中/完売など）
*   🍳 **レシピ（Recipe）**: バナー内での補助情報（独立ページなし）

※ 従来の独立した「ことづてページ」「レシピページ」は廃止されました。すべてマップ上のショップバナーまたは詳細パネルに統合されます。

🛠 技術スタック（プロジェクト全体）

*   Next.js 16+ (App Router)
*   React + TypeScript
*   Tailwind CSS
*   Supabase
*   Leaflet（マップ描画）

1. この map ページが担う機能（役割の整理）

app/public/map/page.tsx は、次の機能を持つ「ハブページ」です：

*   **日曜市のマップ表示（VendorMap）**
    *   出店者（Vendor）の場所・ジャンルを可視化
    *   ズーム・パン・モバイル対応

*   **ショップバナー / 詳細パネル（ShopBanner）**
    *   店舗を選択した際に表示される最小情報のパネル
    *   **ことづて（出店状況）**: 「今、店が開いているか」の確認・投票（簡易機能）
    *   **レシピ**: 関連食材がある場合、おすすめレシピを補助的に表示

*   **AI案内役「にちよさん」（MapSuggest / Consultant）**
    *   検索では拾いきれない曖昧な悩みや「おすすめ」を相談
    *   現地での会話へ橋渡しする役割

*   **サイドバー／検索（Sidebar / Search）**
    *   カテゴリや目的でのフィルタ
    *   「確実に知りたい」ニーズへの対応

2. ディレクトリ構成をまず設計してください

まず、app/public/map 以下のディレクトリ構成を テキストで提案してから コードを書いてください。
独立ページ（recipes, kotodute）が廃止され、map機能に取り込まれたことを意識してください。

3. データスキーマ設計（TypeScript 型）

ショップバナーに統合される「ことづて（ステータス）」と「レシピ」の型を定義してください。

```typescript
export interface Vendor {
  id: string;
  name: string;
  genre: VendorGenre;
  // ...
  status?: VendorStatus; // "open" | "closed" | "sold_out" | "unknown"
  relatedRecipes?: RecipeLink[]; // 関連レシピへのリンク情報
}

export type VendorStatus = {
  current: "open" | "closed" | "sold_out" | "unknown";
  lastUpdated: string;
  upvoteCount: number; // 「開いてたよ」の投票数など
};

export interface RecipeLink {
  id: string;
  title: string;
  description?: string; // バナーで表示する短い説明
}
```

4. コンポーネント設計方針

*   **ShopBanner**: マップ上でピンをタップした際に表示。
    *   店名、ジャンル
    *   **StatusBadge**: 「開店中」などのステータス表示（タップで更新/投票可能）
    *   **RecipeChip**: 「この食材のレシピあり」などのチップ表示（タップで詳細モーダルまたは展開）
*   **AI Consultant**: 画面端に常駐、またはボタンで呼び出し。

5. 状態管理の流れ

ショップのステータス更新やレシピ表示のトリガーを含めた、MapPage の状態管理を設計してください。

6. スタイル・アニメーションの方針

*   **全体**: 「安心感」を与えるデザイン。情報の詰め込みすぎを避ける。
*   **モーション**: マップのピンやバナーの出現は、急かさない穏やかなアニメーション。

7. 研究用ログの設計

*   `vendor_selected`: 店舗閲覧
*   `status_updated`: 出店状況の更新/投票
*   `recipe_viewed`: レシピ情報の閲覧
*   `consultation_started`: AI相談の開始

以上を踏まえて、ディレクトリ構成案から順に出力を始め、その後具体的なコードを提示してください。
